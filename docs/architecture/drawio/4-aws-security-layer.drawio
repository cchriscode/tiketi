<mxfile host="app.diagrams.net">
  <diagram id="security-layer" name="Security Architecture - Defense in Depth">
    <mxGraphModel dx="1422" dy="900" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1600" pageHeight="1000" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />

        <!-- Title -->
        <mxCell id="title" value="TIKETI - Security Architecture: 5-Layer Defense in Depth" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=20;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="450" y="20" width="700" height="40" as="geometry" />
        </mxCell>

        <!-- Layer 5 (Outermost) - WAF -->
        <mxCell id="layer5" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#C62828;strokeWidth=3;dashed=0;verticalAlign=top;align=left;spacingLeft=20;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="100" y="100" width="1400" height="800" as="geometry" />
        </mxCell>
        <mxCell id="layer5-label" value="Layer 5: Edge Security - WAF &amp; DDoS Protection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="120" y="110" width="450" height="25" as="geometry" />
        </mxCell>

        <!-- Layer 4 - Network -->
        <mxCell id="layer4" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;strokeWidth=3;dashed=0;verticalAlign=top;align=left;spacingLeft=20;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="150" y="170" width="1300" height="680" as="geometry" />
        </mxCell>
        <mxCell id="layer4-label" value="Layer 4: Network Security - VPC &amp; Security Groups" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#F57C00;" vertex="1" parent="1">
          <mxGeometry x="170" y="180" width="450" height="25" as="geometry" />
        </mxCell>

        <!-- Layer 3 - Application -->
        <mxCell id="layer3" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#388E3C;strokeWidth=3;dashed=0;verticalAlign=top;align=left;spacingLeft=20;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="200" y="240" width="1200" height="560" as="geometry" />
        </mxCell>
        <mxCell id="layer3-label" value="Layer 3: Application Security - Authentication &amp; Authorization" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#388E3C;" vertex="1" parent="1">
          <mxGeometry x="220" y="250" width="550" height="25" as="geometry" />
        </mxCell>

        <!-- Layer 2 - Data Encryption -->
        <mxCell id="layer2" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E3F2FD;strokeColor=#1976D2;strokeWidth=3;dashed=0;verticalAlign=top;align=left;spacingLeft=20;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="250" y="310" width="1100" height="440" as="geometry" />
        </mxCell>
        <mxCell id="layer2-label" value="Layer 2: Data Encryption - At Rest &amp; In Transit" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#1976D2;" vertex="1" parent="1">
          <mxGeometry x="270" y="320" width="450" height="25" as="geometry" />
        </mxCell>

        <!-- Layer 1 (Core) - Monitoring -->
        <mxCell id="layer1" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E5F5;strokeColor=#7B1FA2;strokeWidth=3;dashed=0;verticalAlign=top;align=left;spacingLeft=20;spacingTop=15;" vertex="1" parent="1">
          <mxGeometry x="300" y="380" width="1000" height="320" as="geometry" />
        </mxCell>
        <mxCell id="layer1-label" value="Layer 1: Monitoring &amp; Audit - Continuous Security" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=16;fontStyle=1;fontColor=#7B1FA2;" vertex="1" parent="1">
          <mxGeometry x="320" y="390" width="450" height="25" as="geometry" />
        </mxCell>

        <!-- Layer 5 Content - WAF -->
        <mxCell id="waf" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.waf;" vertex="1" parent="1">
          <mxGeometry x="700" y="105" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="waf-label" value="AWS WAF" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="680" y="140" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="shield" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.shield;" vertex="1" parent="1">
          <mxGeometry x="830" y="105" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="shield-label" value="AWS Shield" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="810" y="140" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="waf-rules" value="âœ“ SQL Injection Protection&#xa;âœ“ XSS Attack Blocking&#xa;âœ“ Rate Limiting (100 req/5min/IP)&#xa;âœ“ Geo-blocking (malicious regions)&#xa;âœ“ Bot Detection &amp; Mitigation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#C62828;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="960" y="105" width="260" height="100" as="geometry" />
        </mxCell>

        <!-- Layer 4 Content - Network -->
        <mxCell id="vpc" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#8C4FFF;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.vpc;" vertex="1" parent="1">
          <mxGeometry x="700" y="180" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vpc-label" value="VPC" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="680" y="210" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="nacl" value="ðŸ›¡ï¸" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=40;" vertex="1" parent="1">
          <mxGeometry x="830" y="175" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="nacl-label" value="Network ACL" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="810" y="210" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="sg-rules" value="Security Group Rules:&#xa;&#xa;â€¢ ALB-SG: &#xa;  Inbound: 80/443 from 0.0.0.0/0&#xa;  Outbound: All to EKS-Node-SG&#xa;&#xa;â€¢ EKS-Node-SG:&#xa;  Inbound: Custom from ALB-SG only&#xa;  Outbound: 5432 to RDS-SG, 6379 to Redis-SG&#xa;&#xa;â€¢ RDS-SG:&#xa;  Inbound: 5432 from EKS-Node-SG only&#xa;  Outbound: None&#xa;&#xa;â€¢ Redis-SG:&#xa;  Inbound: 6379 from EKS-Node-SG only&#xa;  Outbound: None" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#F57C00;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="960" y="175" width="280" height="220" as="geometry" />
        </mxCell>

        <!-- Layer 3 Content - Application -->
        <mxCell id="cognito" value="ðŸ”" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=40;" vertex="1" parent="1">
          <mxGeometry x="700" y="245" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="cognito-label" value="JWT Auth" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="680" y="280" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="secrets" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.secrets_manager;" vertex="1" parent="1">
          <mxGeometry x="830" y="250" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="secrets-label" value="Secrets&#xa;Manager" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="810" y="280" width="100" height="30" as="geometry" />
        </mxCell>

        <mxCell id="app-security" value="Application Security:&#xa;&#xa;ðŸ”‘ Authentication:&#xa;â€¢ JWT Token with RS256 (Asymmetric)&#xa;â€¢ Access Token: 7-day expiration&#xa;â€¢ Refresh Token: 30-day expiration&#xa;â€¢ Token stored in httpOnly cookie&#xa;&#xa;ðŸ›¡ï¸ Authorization:&#xa;â€¢ Role-Based Access Control (RBAC)&#xa;â€¢ Roles: USER, ADMIN&#xa;â€¢ Permission checks on each endpoint&#xa;&#xa;ðŸ”’ Input Validation:&#xa;â€¢ Schema validation (Joi/Zod)&#xa;â€¢ Sanitization against XSS&#xa;â€¢ SQL injection prevention (Parameterized queries)&#xa;&#xa;ðŸš« CORS Policy:&#xa;â€¢ Whitelist: tiketi.com only&#xa;â€¢ Credentials: true (cookies)&#xa;â€¢ Methods: GET, POST, PUT, DELETE" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#388E3C;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="960" y="245" width="320" height="305" as="geometry" />
        </mxCell>

        <!-- Layer 2 Content - Encryption -->
        <mxCell id="kms" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.key_management_service;" vertex="1" parent="1">
          <mxGeometry x="700" y="320" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="kms-label" value="AWS KMS" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=12;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="680" y="355" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="acm" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.certificate_manager_3;" vertex="1" parent="1">
          <mxGeometry x="830" y="320" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="acm-label" value="ACM&#xa;Certificates" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="810" y="355" width="100" height="30" as="geometry" />
        </mxCell>

        <mxCell id="encryption-details" value="ðŸ” Encryption at Rest:&#xa;&#xa;â€¢ RDS Aurora: AES-256 encryption&#xa;  - KMS Customer Managed Key (CMK)&#xa;  - Automated backup encryption&#xa;  - Replica encryption enabled&#xa;&#xa;â€¢ ElastiCache Redis: AES-256&#xa;  - At-rest encryption for persistence&#xa;  - Snapshot encryption&#xa;&#xa;â€¢ S3 Buckets: Server-Side Encryption (SSE-KMS)&#xa;  - Static assets (React build)&#xa;  - Logs and backups&#xa;&#xa;ðŸ”’ Encryption in Transit:&#xa;&#xa;â€¢ TLS 1.3 (minimum TLS 1.2)&#xa;â€¢ ALB â†’ EKS: HTTPS only&#xa;â€¢ EKS â†’ RDS: SSL/TLS connection&#xa;â€¢ EKS â†’ Redis: TLS enabled&#xa;â€¢ Payment Gateway: PCI-DSS compliant TLS&#xa;&#xa;ðŸ”‘ Certificate Management:&#xa;â€¢ AWS ACM for SSL/TLS certificates&#xa;â€¢ Auto-renewal 60 days before expiry&#xa;â€¢ SNI support for multi-domain" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#1976D2;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="960" y="320" width="340" height="380" as="geometry" />
        </mxCell>

        <!-- Layer 1 Content - Monitoring -->
        <mxCell id="cloudwatch" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.cloudwatch_2;" vertex="1" parent="1">
          <mxGeometry x="380" y="430" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="cloudwatch-label" value="CloudWatch" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="360" y="495" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="cloudtrail" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.cloudtrail;" vertex="1" parent="1">
          <mxGeometry x="500" y="430" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="cloudtrail-label" value="CloudTrail" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="480" y="495" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="guardduty" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.guardduty;" vertex="1" parent="1">
          <mxGeometry x="620" y="430" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="guardduty-label" value="GuardDuty" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="600" y="495" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="config" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#E7157B;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.config;" vertex="1" parent="1">
          <mxGeometry x="380" y="570" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="config-label" value="AWS Config" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="360" y="635" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="inspector" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.inspector;" vertex="1" parent="1">
          <mxGeometry x="500" y="570" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="inspector-label" value="Inspector" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="480" y="635" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="securityhub" value="" style="sketch=0;points=[[0,0,0],[0.25,0,0],[0.5,0,0],[0.75,0,0],[1,0,0],[0,1,0],[0.25,1,0],[0.5,1,0],[0.75,1,0],[1,1,0],[0,0.25,0],[0,0.5,0],[0,0.75,0],[1,0.25,0],[1,0.5,0],[1,0.75,0]];outlineConnect=0;fontColor=#232F3E;fillColor=#DD344C;strokeColor=#ffffff;dashed=0;verticalLabelPosition=bottom;verticalAlign=top;align=center;html=1;fontSize=12;fontStyle=0;aspect=fixed;shape=mxgraph.aws4.resourceIcon;resIcon=mxgraph.aws4.security_hub;" vertex="1" parent="1">
          <mxGeometry x="620" y="570" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="securityhub-label" value="Security Hub" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="600" y="635" width="100" height="20" as="geometry" />
        </mxCell>

        <mxCell id="monitoring-details" value="ðŸ“Š Continuous Monitoring:&#xa;&#xa;CloudWatch:&#xa;â€¢ CPU, Memory, Disk metrics (1-min interval)&#xa;â€¢ Application logs aggregation&#xa;â€¢ Custom metrics: Queue length, Reservation rate&#xa;â€¢ Alarms: CPU &gt; 80%, Error rate &gt; 5%&#xa;&#xa;CloudTrail:&#xa;â€¢ All API calls logged (S3 bucket)&#xa;â€¢ IAM access audit trail&#xa;â€¢ Compliance evidence collection&#xa;&#xa;GuardDuty:&#xa;â€¢ Threat detection (ML-based)&#xa;â€¢ Anomaly detection for API calls&#xa;â€¢ Malware/Cryptocurrency mining detection&#xa;&#xa;AWS Config:&#xa;â€¢ Resource configuration tracking&#xa;â€¢ Compliance rules (CIS AWS Foundations)&#xa;â€¢ Change history retention: 7 years&#xa;&#xa;Inspector:&#xa;â€¢ Vulnerability scanning (ECR images)&#xa;â€¢ Network exposure analysis&#xa;â€¢ CVE detection and patching&#xa;&#xa;Security Hub:&#xa;â€¢ Centralized security findings&#xa;â€¢ PCI-DSS compliance checks&#xa;â€¢ Automated remediation workflows" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFFFFF;strokeColor=#7B1FA2;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="740" y="430" width="300" height="400" as="geometry" />
        </mxCell>

        <mxCell id="incident-response" value="ðŸš¨ Incident Response:&#xa;&#xa;Detection:&#xa;â€¢ Real-time alerts via SNS&#xa;â€¢ Slack/Email notifications&#xa;â€¢ PagerDuty integration&#xa;&#xa;Response:&#xa;â€¢ Automated Lambda remediation&#xa;â€¢ Security Group isolation&#xa;â€¢ Snapshot for forensics&#xa;&#xa;Recovery:&#xa;â€¢ Rollback to last good state&#xa;â€¢ Automated failover (RDS)&#xa;â€¢ Backup restoration (&lt; 15 min)&#xa;&#xa;Forensics:&#xa;â€¢ CloudTrail logs preserved&#xa;â€¢ VPC Flow Logs analysis&#xa;â€¢ GuardDuty findings review" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF3E0;strokeColor=#F57C00;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="1080" y="570" width="200" height="260" as="geometry" />
        </mxCell>

        <!-- Threat Model -->
        <mxCell id="threat-box" value="ðŸŽ¯ Threat Model &amp; Mitigations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEBEE;strokeColor=#C62828;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=13;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="1310" y="100" width="180" height="750" as="geometry" />
        </mxCell>

        <mxCell id="threat1" value="1. DDoS Attack" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="130" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat1-mitigation" value="â†’ AWS Shield Standard&#xa;â†’ WAF rate limiting&#xa;â†’ CloudFront caching" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="150" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat2" value="2. SQL Injection" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="205" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat2-mitigation" value="â†’ WAF SQL injection rules&#xa;â†’ Parameterized queries&#xa;â†’ ORM (Prisma/TypeORM)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="225" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat3" value="3. XSS Attack" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="280" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat3-mitigation" value="â†’ WAF XSS filtering&#xa;â†’ Content Security Policy&#xa;â†’ Input sanitization" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="300" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat4" value="4. Credential Theft" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="355" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat4-mitigation" value="â†’ Secrets Manager rotation&#xa;â†’ IAM least privilege&#xa;â†’ MFA enforcement" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="375" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat5" value="5. Data Breach" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="430" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat5-mitigation" value="â†’ KMS encryption at rest&#xa;â†’ TLS 1.3 in transit&#xa;â†’ Private subnets isolation" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="450" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat6" value="6. Insider Threat" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="505" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat6-mitigation" value="â†’ CloudTrail logging&#xa;â†’ GuardDuty anomaly detect&#xa;â†’ IAM access review" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="525" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat7" value="7. Man-in-Middle" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="580" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat7-mitigation" value="â†’ TLS everywhere&#xa;â†’ Certificate pinning&#xa;â†’ HSTS header" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="600" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat8" value="8. Account Takeover" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="655" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat8-mitigation" value="â†’ Password complexity&#xa;â†’ Rate limiting login&#xa;â†’ Session timeout (7 days)" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="675" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat9" value="9. Supply Chain" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="730" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat9-mitigation" value="â†’ ECR image scanning&#xa;â†’ Inspector vulnerability check&#xa;â†’ Dependabot alerts" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="750" width="150" height="45" as="geometry" />
        </mxCell>

        <mxCell id="threat10" value="10. Zero-Day Exploit" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#C62828;" vertex="1" parent="1">
          <mxGeometry x="1320" y="805" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="threat10-mitigation" value="â†’ Auto-patching (Systems Mgr)&#xa;â†’ Immutable infrastructure&#xa;â†’ Blue-green deployment" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=9;fontColor=#666666;" vertex="1" parent="1">
          <mxGeometry x="1330" y="825" width="150" height="45" as="geometry" />
        </mxCell>

        <!-- Compliance -->
        <mxCell id="compliance-box" value="âœ… Compliance Standards:&#xa;&#xa;â€¢ PCI-DSS Level 1&#xa;  (Payment card security)&#xa;&#xa;â€¢ GDPR&#xa;  (EU user data protection)&#xa;&#xa;â€¢ SOC 2 Type II&#xa;  (Security controls)&#xa;&#xa;â€¢ ISO 27001&#xa;  (Information security)&#xa;&#xa;â€¢ CIS AWS Foundations&#xa;  (AWS best practices)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#E8F5E9;strokeColor=#388E3C;align=left;verticalAlign=top;spacingLeft=10;spacingTop=5;fontSize=11;" vertex="1" parent="1">
          <mxGeometry x="1080" y="430" width="200" height="260" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
